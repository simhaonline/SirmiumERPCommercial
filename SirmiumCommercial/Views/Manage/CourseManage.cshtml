@model CourseViewModel

@{
    Layout = "_UserLayout";
    ViewData["Title"] = "Manage -" + Model.Course.Title;
}

@section Styles {
    <environment names="Development,Staging,Production">
        <link rel="stylesheet" href="~/lib_local/css_local/UserLocal.css" />
        <link rel="stylesheet" href="~/lib_local/presentationForms/presentationForm.css" />
    </environment>
}

<div id="customSuccessWindow"></div>
@if (TempData["messageCM"] != null)
{
    <input value="@TempData["messageCM"].ToString()" id="msgText" hidden />
    <script>
        var msg = document.getElementById('msgText').value;
        window.onload = function () {
            CustomSuccessWindow.show(msg);
        };

        /**/</script>
}

<!--Warning Window-->
<div id="customWarningDialog"></div>

<!--Msg window-->
@if (TempData["succMsgCM"] != null)
{
    <div id="msgWindowSuccess">
        <input value="@TempData["succMsgCM"]" id="windowMsg" hidden />
    </div>
}
@if (TempData["errMsgCM"] != null)
{
    <div id="msgWindowError">
        <input value="@TempData["errMsgCM"]" id="windowMsg" hidden />
    </div>
}

<!--New Presentation Form-->
<div>
    @Html.Partial("NewPresentationForm", new NewEditPresentation
    {
        CourseId = Model.Course.CourseId,
        Presentation = new Presentation()
    })
</div>

<div class="col-lg-12">
    <div class="col-lg-2 text-center p-lg">
        <h5 class="text-muted">Award</h5>
        <h1>
            <span class="@Model.Course.AwardIcon text-big"></span>
        </h1>
    </div>
    <div class="col-lg-3">
        <h2>
            @Model.Course.Title
        </h2>
        <h4>
            by:
            @if (Model.User != null)
            {
                <span class="text-info">
                    &#64;@Model.User.UserName
                </span>
            }
            else
            {
                <span class="text-info"> &#64;SirmiumCommercial</span>
            }
        </h4>
        <h5><span class="fa fa-plus-circle"></span> Added: @Model.Course.DateAdded.ToString()</h5>
        <h5><span class="fa fa-pencil-square-o"></span> Date modified: @Model.Course.DateAdded.ToString()</h5>
    </div>
    <div class="col-lg-2">
        @if (Model.Course.Presentations.Count() > 0)
        {
            <h4>Parts: <span class="text-warning">@Model.Course.Presentations.Count()</span>   </h4>
        }
        else
        {
            <h4>Parts: <span class="text-danger">0</span></h4>
        }
        <h5>
            <span class="fa fa-clock-o"></span>End Date:
            @if (Model.Course.EndDate != DateTime.MinValue)
            {
                <span class="text-danger">
                    @Model.Course.EndDate.ToShortDateString()
                </span>
            }
            else
            {
                <span class="text-success">
                    NO END DATE
                </span>
            }
        </h5>
        @if ((DateTime.Now > Model.Course.EndDate) &&
(Model.Course.EndDate != DateTime.MinValue))
        {
            <h4>
                <span class="badge badge-danger text-warning" style="font-size:16px">
                    <b>FINISHED</b>
                </span>
            </h4>
        }
    </div>
    <div class="col-md-1"></div>
    <div class="col-md-2 text-center">
        @if (Model.User != null &&
Model.User.Id == ViewData["Id"].ToString())
        {
            <div class="dropdown">
                <a class="dropdown-toggle btn btn-info" href="#" data-toggle="dropdown">
                    Settings <i class="fa fa-cog"></i>
                </a>
                <div class="dropdown-menu hdropdown bigmenu animated flipInX">
                    <table>
                        <tbody>
                            <tr>
                                <td>
                                    <a onclick="CustomWarningWindow.show(
                                        'Are you sure you want to delete @Model.Course.Title?',
                                        'Yes, delete it!',
                                        '@Url.Action("DeleteCourse", "Manage",
                                            new { id = ViewData["Id"],
                                                courseId = Model.Course.CourseId })')"
                                       class="btn btn-outline btn-danger2">
                                        Delete <br /> <i class="far fa-trash-alt"></i>
                                    </a>
                                </td>
                                <td>
                                    <a onclick="NewPresentation.show()"
                                       class="btn btn-outline btn-success m-t-md">
                                        Add Presentation <br /> <i class="fas fa-plus"></i>
                                    </a>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <a href="@Url.Action("EditCourse", "Manage",
                                           new { id = ViewData["Id"], courseId = Model.Course.CourseId })"
                                       class="btn btn-outline btn-warning2 m-t-md">
                                        Edit <br /> <i class="far fa-edit"></i>
                                    </a>
                                </td>
                                <td>
                                    <a onclick="NewPresentation.show()"
                                       class="btn btn-outline btn-primary m-t-md">
                                        Add User <br /> <i class="fas fa-user-plus"></i>
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <br />
            @if (Model.Course.Status == "Private")
            {
                <a onclick="CustomWarningWindow.show(
                        'Are you sure you want to share @Model.Course.Title?',
                         'Yes',
                        '@Url.Action("ChangeCourseStatus", "Manage",
                          new { id = ViewData["Id"], courseId = Model.Course.CourseId })')"
                   class="btn btn-primary2">
                    Share <i class="fas fa-share"></i>
                </a>
            }
            else
            {
                <a onclick="CustomWarningWindow.show(
                        'Are you sure you want to hide @Model.Course.Title?',
                         'Yes',
                        '@Url.Action("ChangeCourseStatus", "Manage",
                          new { id = ViewData["Id"], courseId = Model.Course.CourseId })')"
                   class="btn btn-danger2">
                    Hide <i class="far fa-eye-slash"></i>
                </a>
            }
        }
    </div>
</div>

@if (Model.Course.Description != null)
{
    <div class="row m-sm p-sm">
        <div class="col-md-1"></div>
        <div class="col-md-10 borderDashed" style="">
            <h4>Description:</h4>
            <span class="text-info">@Model.Course.Description</span>
            <br />
            <br />
        </div>
    </div>
}

<!--Show presentation or users on course-->
<div id="topNav" class="row m-b-sm">
    <div class="col-lg-3 navBtn" id="showPresentationsBtn">
        <h2 class="m-l-sm"><strong>Presentations</strong></h2>
    </div>
    <div class="col-lg-3 navBtn" id="showUsersBtn">
        <h2 class="m-l-sm"><strong>Users</strong></h2>
    </div>
</div>
<div id="showPresentations" style="">
    @Html.Partial("AllPresentations", Model);
</div>
<div id="showUsers" style="display: none">
    @Html.Partial("AllUsers", Model)
</div>


@section Scripts {
    <environment names="Development,Staging,Production">
        <script src="~/lib_local/presentationForms/presentationForm.js"></script>
    </environment>
}